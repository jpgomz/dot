#!/usr/bin/env bash
set -euo pipefail

echo "ğŸŒ€ Obteniendo la Ãºltima versiÃ³n de Neovim (Linux x86_64)â€¦"

asset_url=$(curl -s https://api.github.com/repos/neovim/neovim-releases/releases/latest \
  | jq -r '.assets[]
      | select(.name == "nvim-linux-x86_64.tar.gz")
      | .browser_download_url')

if [[ -z "$asset_url" ]]; then
  echo "âŒ No se encontrÃ³ el asset 'nvim-linux-x86_64.tar.gz'."
  exit 1
fi

tmp_dir=$(mktemp -d)
cd "$tmp_dir"

echo "â¬‡ï¸ Descargando: $asset_url"
curl -LO "$asset_url"

echo "ğŸ“¦ Descomprimiendoâ€¦"
tar xzf nvim-linux-x86_64.tar.gz

echo "ğŸ“ Instalando en ~/.local"
rm -rf ~/.local/nvim
mv nvim-linux-x86_64 ~/.local/nvim

echo "ğŸ”— Enlazando ejecutable en ~/.local/bin"
mkdir -p ~/.local/bin
ln -sf ~/.local/nvim/bin/nvim ~/.local/bin/nvim

echo "âœ… InstalaciÃ³n finalizada."

echo -e "\nğŸ” VerificaciÃ³n:"
nvim --version | head -n 1
